<mat-toolbar>
    <button mat-icon-button arial-label="Back to account list" [routerLink]="['/main/admin/account']"><mat-icon>back</mat-icon></button>
    <span class="fill-remain-space"></span>
    <button *ngIf="!isEditing" mat-flat-button color="primary" (click)="editThisAccount()">Edit</button>
    <button *ngIf="isEditing" mat-flat-button color="accent" (click)="saveEditedAccount()" class="margin-righ-16">Save</button>
    <button *ngIf="isEditing" mat-flat-button color="warn" (click)="cancelEditedAccount()">Cancel</button>
</mat-toolbar>

<div fxLayout="row" fxLayoutGap="16px" class="padding-16">
    <div fxFlex="67">
        <div fxLayout="column">
            <mat-form-field class="full-width">
                <input matInput i18n-placeholder placeholder="Account ID" name="acc-account-id" [(ngModel)]="account.accountId" required [disabled]="!isEditing">
            </mat-form-field>
            <div fxLayout="row" fxLayout.xs="column" fxLayoutGap="16px" fxLayoutGap.xs="0px">
                <div fxFlex="50">
                    <mat-form-field class="full-width">
                        <input type="password" matInput i18n-placeholder placeholder="Password" name="acc-password" [(ngModel)]="password" [disabled]="!isEditing">
                    </mat-form-field>
                </div>
                <div fxFlex="50">
                    <mat-form-field class="full-width">
                        <input type="password" matInput i18n-placeholder placeholder="Re-type Password" name="acc-re-password" [(ngModel)]="rePassword" [disabled]="!isEditing">
                    </mat-form-field>
                </div>
            </div>

            <div fxLayout="row" fxLayout.xs="column" fxLayoutGap="16px" fxLayoutGap.xs="0px">
                <div fxFlex="50">
                    <mat-form-field class="full-width">
                        <input matInput i18n-placeholder placeholder="First Name" name="acc-first-name" [(ngModel)]="account.firstName" [disabled]="!isEditing">
                    </mat-form-field>
                </div>
                <div fxFlex="50">
                    <mat-form-field class="full-width">
                        <input matInput i18n-placeholder placeholder="Last Name" name="acc-last-name" [(ngModel)]="account.lastName" [disabled]="!isEditing">
                    </mat-form-field>
                </div>
            </div>

            <div fxLayout="row" fxLayoutGap="16px">
                <div fxFlex="50">
                    <mat-form-field class="full-width">
                        <mat-select matInput placeholder="Roles" [(ngModel)]="account.privilege" [disabled]="!isEditing">
                            <mat-option *ngFor="let pri of privilegeList" [value]="pri.id">{{pri.name}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
            </div>



            <mat-form-field class="full-width">
                <input type="text"  placeholder="Status" aria-label="Status" matInput [formControl]="statusControl" [matAutocomplete]="autoStatus">
                <mat-autocomplete #autoStatus="matAutocomplete">
                    <mat-option *ngFor="let status of filteredStatus | async" [value]="status">
                        {{status}}
                    </mat-option>
                </mat-autocomplete>
            </mat-form-field>


            <div fxLayout="row" fxLayoutGap="16px">
                <div fxFlex="50">
                    <mat-form-field class="full-width">
                        <input matInput i18n-placeholder placeholder="Phone Number" name="acc-phone-number" [(ngModel)]="account.phoneNumber" [disabled]="!isEditing">
                    </mat-form-field>
                </div>
                <div fxFlex="50">
                    <mat-form-field class="full-width">
                        <input matInput i18n-placeholder placeholder="Email Address" name="acc-email-address" [(ngModel)]="account.emailAddress" required [disabled]="!isEditing">
                    </mat-form-field>
                </div>
            </div>
            <mat-form-field class="full-width">
                <input matInput i18n-placeholder placeholder="Address Line1" name="acc-address-line1" [(ngModel)]="account.addressLine1" [disabled]="!isEditing">
            </mat-form-field>
            <mat-form-field class="full-width">
                <input matInput i18n-placeholder placeholder="Address Line2" name="acc-address-line2" [(ngModel)]="account.addressLine2" [disabled]="!isEditing">
            </mat-form-field>

            <mat-form-field class="full-width">
                <input matInput i18n-placeholder placeholder="Notes" name="acc-notes" [(ngModel)]="account.notes" [disabled]="!isEditing">
            </mat-form-field>

        </div>
    </div>
    <div fxFlex="33">
        <table mat-table [dataSource]="account.smtpProperties" multiTemplateDataRows>

            <ng-container matColumnDef="{{column}}" *ngFor="let column of columnsToDisplay">
                <th mat-header-cell *matHeaderCellDef>{{column}}</th>
                <td mat-cell *matCellDef="let element">{{element[column]}}</td>
            </ng-container>

            <ng-container matColumnDef="expandedDetail">
                <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
                    <div class="element-detail" [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                        <div class="element-diagram">
                            <div class="">{{element.host}}</div>
                            <div class="">{{element.port}}</div>
                        </div>
                    </div>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
            <tr mat-row *matRowDef="let element; columns: columnsToDisplay;" class="element-row"
                [class.expanded-row]="expandedElement === element"
                (click)="expandedElement = expandedElement === element ? null : element"></tr>
            <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="detail-row"></tr>
        </table>


        <div>
            <div *ngIf="isAddNewSmtp">
                <div fxLayout.gt-sm="row" fxLayoutGap="16px">
                    <div fxFlex.gt-sm="80" fxFlex.lt-sm="100">
                        <mat-form-field class="full-width">
                            <label>
                                <input matInput i18n-placeholder placeholder="Host" name="smtp-host" [(ngModel)]="aNewSmtpServer.host">
                            </label>
                        </mat-form-field>
                    </div>
                    <div fxFlex.gt-sm="20" fxFlex.lt-sm="100">
                        <mat-form-field class="full-width">
                            <label>
                                <input matInput i18n-placeholder placeholder="Port" name="smtp-port" [(ngModel)]="aNewSmtpServer.port">
                            </label>
                        </mat-form-field>
                    </div>
                </div>
                <div fxLayoutGap.gt-sm="row" fxLayoutGap="16px">
                    <div fxFlex="50">
                        <mat-form-field class="full-width">
                            <label>
                                <input matInput i18n-placeholder placeholder="Username" name="smtp-username" [(ngModel)]="aNewSmtpServer.username">
                            </label>
                        </mat-form-field>
                    </div>
                    <div fxFlex="50">
                        <mat-form-field class="full-width">
                            <label>
                                <input matInput i18n-placeholder placeholder="Password" name="smtp-password" [(ngModel)]="aNewSmtpServer.password">
                            </label>
                        </mat-form-field>
                    </div>
                </div>

                <div fxLayoutGap.gt-sm="row" fxLayoutGap="16px">
                    <div fxFlex.gt-sm="80">
                        <mat-form-field class="full-width">
                            <label>
                                <input matInput i18n-placeholder type="number" placeholder="Max size attachment" name="smtp-max-size-attachment" [(ngModel)]="aNewSmtpServer.maxSizeAttachment">
                            </label>
                        </mat-form-field>
                    </div>
                    <div fxFlex.gt-sm="20">
                        <mat-form-field class="full-width">
                            <label>
                                <input matInput i18n-placeholder placeholder="Unit" name="max-size-unit" value="MB" disabled>
                            </label>
                        </mat-form-field>
                    </div>
                </div>
                <div fxLayoutGap.gt-sm="row" fxLayoutGap="16px">
                    <div fxFlex.gt-sm="50">
                        <mat-checkbox [(ngModel)]="aNewSmtpServer.auth">Authentication</mat-checkbox>
                    </div>
                    <div fxFlex.gt-sm="50">
                        <mat-checkbox [(ngModel)]="aNewSmtpServer.startTls">Start TLS</mat-checkbox>
                    </div>
                </div>
            </div>

            <mat-divider></mat-divider>

            <div class="center">
                <button *ngIf="!isAddNewSmtp" mat-flat-button color="primary" (click)="addNewSmtpServer()">Add New SMTP Server</button>
                <button *ngIf="isAddNewSmtp" mat-flat-button color="primary" (click)="saveNewSmtpServer()" class="margin-righ-16">Save</button>
                <button *ngIf="isAddNewSmtp" mat-flat-button color="warn" (click)="cancelNewSmtpServer()">Cancel</button>
            </div>
        </div>
    </div>
</div>


